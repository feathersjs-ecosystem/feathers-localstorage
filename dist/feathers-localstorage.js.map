{"version":3,"sources":["webpack://feathers.localstorage/webpack/universalModuleDefinition","webpack://feathers.localstorage/webpack/bootstrap","webpack://feathers.localstorage/./lib/index.js","webpack://feathers.localstorage/../src/filter-query.ts","webpack://feathers.localstorage/../src/index.ts","webpack://feathers.localstorage/../src/service.ts","webpack://feathers.localstorage/../src/sort.ts","webpack://feathers.localstorage/../src/hooks.ts","webpack://feathers.localstorage/../src/utils.ts","webpack://feathers.localstorage/./node_modules/@feathersjs/errors/lib/index.js","webpack://feathers.localstorage/./node_modules/debug/src/browser.js","webpack://feathers.localstorage/./node_modules/debug/src/common.js","webpack://feathers.localstorage/./node_modules/feathers-memory/lib/index.js","webpack://feathers.localstorage/./node_modules/ms/index.js","webpack://feathers.localstorage/./node_modules/process/browser.js","webpack://feathers.localstorage/./node_modules/sift/src/index.js"],"names":["require","Service","usedKeys","LocalStorage","options","_storageKey","name","_storage","storage","window","localStorage","_throttle","throttle","_reuseKeys","reuseKeys","store","Error","indexOf","push","ready","Promise","resolve","getItem","then","str","JSON","parse","keys","Object","last","length","_uId","id","data","_timeout","setTimeout","setItem","stringify","method","args","execute","flush","module","exports","init","debug","FeathersError","msg","code","className","errors","message","newData","type","captureStackTrace","stack","inheritsFrom","Child","Parent","prototype","create","constructor","defineProperty","value","BadRequest","call","NotAuthenticated","PaymentError","Forbidden","NotFound","MethodNotAllowed","NotAcceptable","Timeout","Conflict","LengthRequired","Unprocessable","TooManyRequests","GeneralError","NotImplemented","BadGateway","Unavailable","convert","error","result","assign","log","formatArgs","save","load","useColors","localstorage","colors","process","__nwjs","navigator","userAgent","toLowerCase","match","document","documentElement","style","WebkitAppearance","console","firebug","exception","table","parseInt","RegExp","$1","namespace","humanize","diff","c","color","splice","index","lastC","replace","namespaces","removeItem","r","env","DEBUG","formatters","j","v","setup","createDebug","default","coerce","disable","enable","enabled","forEach","key","instances","names","skips","selectColor","hash","i","charCodeAt","Math","abs","prevTime","self","curr","Number","Date","ms","prev","unshift","format","formatter","val","logFn","apply","destroy","extend","delimiter","newDebug","split","len","substr","instance","map","toNamespace","join","test","regexp","toString","substring","_","sorter","select","AdapterService","sift","_select","base","matcher","startId","params","filterQuery","query","_find","paginate","filters","values","filter","total","$sort","undefined","sort","$skip","slice","$limit","limit","skip","Array","isArray","all","current","_create","_get","oldEntry","oldId","patchEntry","entry","currentId","omit","getEntries","entries","_remove","typeChecker","typeString","isObject","isFunction","get","obj","nestable","validator","validateOptions","valueOwner","nestedResults","Boolean","find","or","n","and","validate","defaultExpressions","$eq","$ne","$gt","$gte","$lt","$lte","$mod","$in","$nin","$not","$type","testType","$all","allOptions","$and","$size","sizeMatch","$or","orOptions","$nor","$regex","$where","$elemMatch","search","$exists","hasOwnProperty","prepare","queryOwner","comparable","compare","Function","comparableValue","String","createRootValidator","eq","$options","array","createValidator","validatedNested","keyPath","child","results","findValues","inclusive","allValid","allValues","keypath","object","k","isNaN","createNestedValidator","isVanillaObject","expressions","wrapQuery","parseQuery","validators","queryValue","expression","keyParts","parseNested","isExactObject","isEqual","parseRoot","a","b","getAllKeys","allKeysHash","getTime","toJSON"],"mappings":"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ACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;ACjKA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA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","file":"feathers-localstorage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"localstorage\"] = factory();\n\telse\n\t\troot[\"feathers\"] = root[\"feathers\"] || {}, root[\"feathers\"][\"localstorage\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib/index.js\");\n","const { Service } = require('feathers-memory');\n\nconst usedKeys = [];\n\nclass LocalStorage extends Service {\n  constructor (options = {}) {\n    super(options);\n    this._storageKey = options.name || 'feathers';\n    this._storage = options.storage || (typeof window !== 'undefined' && window.localStorage);\n    this._throttle = options.throttle || 200;\n    this._reuseKeys = options.reuseKeys || false;\n    this.store = null;\n\n    if (!this._storage) {\n      throw new Error('The `storage` option needs to be provided');\n    }\n\n    if (usedKeys.indexOf(this._storageKey) === -1) {\n      usedKeys.push(this._storageKey);\n    } else {\n      if (!this._reuseKeys) {\n        throw new Error(`The storage name '${this._storageKey}' is already in use by another instance.`);\n      }\n    }\n\n    this.ready();\n  }\n\n  ready () {\n    if (!this.store) {\n      return Promise.resolve(this._storage.getItem(this._storageKey))\n        .then(str => JSON.parse(str || '{}'))\n        .then(store => {\n          const keys = Object.keys(store);\n          const last = store[keys[keys.length - 1]];\n\n          // Current id is the id of the last item\n          this._uId = (keys.length && typeof last[this.id] !== 'undefined') ? last[this.id] + 1 : this._uId;\n\n          return (this.store = store);\n        });\n    }\n\n    return Promise.resolve(this.store);\n  }\n\n  flush (data) {\n    if (!this._timeout) {\n      this._timeout = setTimeout(() => {\n        this._storage.setItem(this._storageKey, JSON.stringify(this.store));\n        delete this._timeout;\n      }, this._throttle);\n    }\n\n    return data;\n  }\n\n  execute (method, ...args) {\n    return this.ready()\n      .then(() => super[method](...args));\n  }\n\n  find (...args) {\n    return this.execute('find', ...args);\n  }\n\n  get (...args) {\n    return this.execute('get', ...args);\n  }\n\n  create (...args) {\n    return this.execute('create', ...args)\n      .then(data => this.flush(data));\n  }\n\n  patch (...args) {\n    return this.execute('patch', ...args)\n      .then(data => this.flush(data));\n  }\n\n  update (...args) {\n    return this.execute('update', ...args)\n      .then(data => this.flush(data));\n  }\n\n  remove (...args) {\n    return this.execute('remove', ...args)\n      .then(data => this.flush(data));\n  }\n}\n\nmodule.exports = function init (options) {\n  return new LocalStorage(options);\n};\n\nmodule.exports.Service = Service;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst commons_1 = require(\"@feathersjs/commons\");\nconst errors_1 = require(\"@feathersjs/errors\");\nfunction parse(number) {\n    if (typeof number !== 'undefined') {\n        return Math.abs(parseInt(number, 10));\n    }\n    return undefined;\n}\n// Returns the pagination limit and will take into account the\n// default and max pagination settings\nfunction getLimit(limit, paginate) {\n    if (paginate && paginate.default) {\n        const lower = typeof limit === 'number' && !isNaN(limit) ? limit : paginate.default;\n        const upper = typeof paginate.max === 'number' ? paginate.max : Number.MAX_VALUE;\n        return Math.min(lower, upper);\n    }\n    return limit;\n}\n// Makes sure that $sort order is always converted to an actual number\nfunction convertSort(sort) {\n    if (typeof sort !== 'object' || Array.isArray(sort)) {\n        return sort;\n    }\n    return Object.keys(sort).reduce((result, key) => {\n        result[key] = typeof sort[key] === 'object'\n            ? sort[key] : parseInt(sort[key], 10);\n        return result;\n    }, {});\n}\nfunction cleanQuery(query, operators, filters) {\n    if (Array.isArray(query)) {\n        return query.map(value => cleanQuery(value, operators, filters));\n    }\n    else if (commons_1._.isObject(query) && query.constructor === {}.constructor) {\n        const result = {};\n        commons_1._.each(query, (value, key) => {\n            if (key[0] === '$') {\n                if (filters[key] !== undefined) {\n                    return;\n                }\n                if (!operators.includes(key)) {\n                    throw new errors_1.BadRequest(`Invalid query parameter ${key}`, query);\n                }\n            }\n            result[key] = cleanQuery(value, operators, filters);\n        });\n        Object.getOwnPropertySymbols(query).forEach(symbol => {\n            // @ts-ignore\n            result[symbol] = query[symbol];\n        });\n        return result;\n    }\n    return query;\n}\nfunction assignFilters(object, query, filters, options) {\n    if (Array.isArray(filters)) {\n        commons_1._.each(filters, (key) => {\n            if (query[key] !== undefined) {\n                object[key] = query[key];\n            }\n        });\n    }\n    else {\n        commons_1._.each(filters, (converter, key) => {\n            const converted = converter(query[key], options);\n            if (converted !== undefined) {\n                object[key] = converted;\n            }\n        });\n    }\n    return object;\n}\nexports.FILTERS = {\n    $sort: (value) => convertSort(value),\n    $limit: (value, options) => getLimit(parse(value), options.paginate),\n    $skip: (value) => parse(value),\n    $select: (value) => value\n};\nexports.OPERATORS = ['$in', '$nin', '$lt', '$lte', '$gt', '$gte', '$ne', '$or'];\n// Converts Feathers special query parameters and pagination settings\n// and returns them separately a `filters` and the rest of the query\n// as `query`\nfunction filterQuery(query, options = {}) {\n    const { filters: additionalFilters = {}, operators: additionalOperators = [] } = options;\n    const result = {};\n    result.filters = assignFilters({}, query, exports.FILTERS, options);\n    result.filters = assignFilters(result.filters, query, additionalFilters, options);\n    result.query = cleanQuery(query, exports.OPERATORS.concat(additionalOperators), result.filters);\n    return result;\n}\nexports.default = filterQuery;\nif (typeof module !== 'undefined') {\n    module.exports = Object.assign(filterQuery, module.exports);\n}\n//# sourceMappingURL=filter-query.js.map","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst hookUtils = __importStar(require(\"./hooks\"));\n__export(require(\"./utils\"));\nexports.hooks = hookUtils;\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst errors_1 = require(\"@feathersjs/errors\");\nconst filter_query_1 = __importDefault(require(\"./filter-query\"));\nconst callMethod = (self, name, ...args) => {\n    if (typeof self[name] !== 'function') {\n        return Promise.reject(new errors_1.NotImplemented(`Method ${name} not available`));\n    }\n    return self[name](...args);\n};\nconst alwaysMulti = {\n    find: true,\n    get: false,\n    update: false\n};\nclass AdapterService {\n    constructor(options) {\n        this.options = Object.assign({\n            id: 'id',\n            events: [],\n            paginate: {},\n            multi: false,\n            filters: [],\n            whitelist: []\n        }, options);\n    }\n    get id() {\n        return this.options.id;\n    }\n    get events() {\n        return this.options.events;\n    }\n    filterQuery(params = {}, opts = {}) {\n        const paginate = typeof params.paginate !== 'undefined'\n            ? params.paginate : this.options.paginate;\n        const { query = {} } = params;\n        const options = Object.assign({\n            operators: this.options.whitelist || [],\n            filters: this.options.filters,\n            paginate\n        }, opts);\n        const result = filter_query_1.default(query, options);\n        return Object.assign(result, { paginate });\n    }\n    allowsMulti(method) {\n        const always = alwaysMulti[method];\n        if (typeof always !== 'undefined') {\n            return always;\n        }\n        const option = this.options.multi;\n        if (option === true || option === false) {\n            return option;\n        }\n        else {\n            return option.includes(method);\n        }\n    }\n    find(params) {\n        return callMethod(this, '_find', params);\n    }\n    get(id, params) {\n        return callMethod(this, '_get', id, params);\n    }\n    create(data, params) {\n        if (Array.isArray(data) && !this.allowsMulti('create')) {\n            return Promise.reject(new errors_1.MethodNotAllowed(`Can not create multiple entries`));\n        }\n        return callMethod(this, '_create', data, params);\n    }\n    update(id, data, params) {\n        if (id === null || Array.isArray(data)) {\n            return Promise.reject(new errors_1.BadRequest(`You can not replace multiple instances. Did you mean 'patch'?`));\n        }\n        return callMethod(this, '_update', id, data, params);\n    }\n    patch(id, data, params) {\n        if (id === null && !this.allowsMulti('patch')) {\n            return Promise.reject(new errors_1.MethodNotAllowed(`Can not patch multiple entries`));\n        }\n        return callMethod(this, '_patch', id, data, params);\n    }\n    remove(id, params) {\n        if (id === null && !this.allowsMulti('remove')) {\n            return Promise.reject(new errors_1.MethodNotAllowed(`Can not remove multiple entries`));\n        }\n        return callMethod(this, '_remove', id, params);\n    }\n}\nexports.AdapterService = AdapterService;\n//# sourceMappingURL=service.js.map","\"use strict\";\n// Sorting algorithm taken from NeDB (https://github.com/louischatriot/nedb)\n// See https://github.com/louischatriot/nedb/blob/e3f0078499aa1005a59d0c2372e425ab789145c1/lib/model.js#L189\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction compareNSB(a, b) {\n    if (a < b) {\n        return -1;\n    }\n    if (a > b) {\n        return 1;\n    }\n    return 0;\n}\nexports.compareNSB = compareNSB;\nfunction compareArrays(a, b) {\n    let i;\n    let comp;\n    for (i = 0; i < Math.min(a.length, b.length); i += 1) {\n        comp = exports.compare(a[i], b[i]);\n        if (comp !== 0) {\n            return comp;\n        }\n    }\n    // Common section was identical, longest one wins\n    return exports.compareNSB(a.length, b.length);\n}\nexports.compareArrays = compareArrays;\nfunction compare(a, b, compareStrings = exports.compareNSB) {\n    const { compareNSB, compare, compareArrays } = exports;\n    // undefined\n    if (a === undefined) {\n        return b === undefined ? 0 : -1;\n    }\n    if (b === undefined) {\n        return a === undefined ? 0 : 1;\n    }\n    // null\n    if (a === null) {\n        return b === null ? 0 : -1;\n    }\n    if (b === null) {\n        return a === null ? 0 : 1;\n    }\n    // Numbers\n    if (typeof a === 'number') {\n        return typeof b === 'number' ? compareNSB(a, b) : -1;\n    }\n    if (typeof b === 'number') {\n        return typeof a === 'number' ? compareNSB(a, b) : 1;\n    }\n    // Strings\n    if (typeof a === 'string') {\n        return typeof b === 'string' ? compareStrings(a, b) : -1;\n    }\n    if (typeof b === 'string') {\n        return typeof a === 'string' ? compareStrings(a, b) : 1;\n    }\n    // Booleans\n    if (typeof a === 'boolean') {\n        return typeof b === 'boolean' ? compareNSB(a, b) : -1;\n    }\n    if (typeof b === 'boolean') {\n        return typeof a === 'boolean' ? compareNSB(a, b) : 1;\n    }\n    // Dates\n    if (a instanceof Date) {\n        return b instanceof Date ? compareNSB(a.getTime(), b.getTime()) : -1;\n    }\n    if (b instanceof Date) {\n        return a instanceof Date ? compareNSB(a.getTime(), b.getTime()) : 1;\n    }\n    // Arrays (first element is most significant and so on)\n    if (Array.isArray(a)) {\n        return Array.isArray(b) ? compareArrays(a, b) : -1;\n    }\n    if (Array.isArray(b)) {\n        return Array.isArray(a) ? compareArrays(a, b) : 1;\n    }\n    // Objects\n    const aKeys = Object.keys(a).sort();\n    const bKeys = Object.keys(b).sort();\n    let comp = 0;\n    for (let i = 0; i < Math.min(aKeys.length, bKeys.length); i += 1) {\n        comp = compare(a[aKeys[i]], b[bKeys[i]]);\n        if (comp !== 0) {\n            return comp;\n        }\n    }\n    return compareNSB(aKeys.length, bKeys.length);\n}\nexports.compare = compare;\n// An in-memory sorting function according to the\n// $sort special query parameter\nfunction sorter($sort) {\n    const criteria = Object.keys($sort).map(key => {\n        const direction = $sort[key];\n        return { key, direction };\n    });\n    return function (a, b) {\n        let compare;\n        for (const criterion of criteria) {\n            compare = criterion.direction * exports.compare(a[criterion.key], b[criterion.key]);\n            if (compare !== 0) {\n                return compare;\n            }\n        }\n        return 0;\n    };\n}\nexports.sorter = sorter;\n//# sourceMappingURL=sort.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst utils_1 = require(\"./utils\");\nconst { each, pick } = utils_1._;\nexports.ACTIVATE_HOOKS = utils_1.createSymbol('__feathersActivateHooks');\nfunction createHookObject(method, data = {}) {\n    const hook = {};\n    Object.defineProperty(hook, 'toJSON', {\n        value() {\n            return pick(this, 'type', 'method', 'path', 'params', 'id', 'data', 'result', 'error');\n        }\n    });\n    return Object.assign(hook, data, {\n        method,\n        // A dynamic getter that returns the path of the service\n        get path() {\n            const { app, service } = data;\n            if (!service || !app || !app.services) {\n                return null;\n            }\n            return Object.keys(app.services)\n                .find(path => app.services[path] === service);\n        }\n    });\n}\nexports.createHookObject = createHookObject;\n// Fallback used by `makeArguments` which usually won't be used\nfunction defaultMakeArguments(hook) {\n    const result = [];\n    if (typeof hook.id !== 'undefined') {\n        result.push(hook.id);\n    }\n    if (hook.data) {\n        result.push(hook.data);\n    }\n    result.push(hook.params || {});\n    return result;\n}\nexports.defaultMakeArguments = defaultMakeArguments;\n// Turns a hook object back into a list of arguments\n// to call a service method with\nfunction makeArguments(hook) {\n    switch (hook.method) {\n        case 'find':\n            return [hook.params];\n        case 'get':\n        case 'remove':\n            return [hook.id, hook.params];\n        case 'update':\n        case 'patch':\n            return [hook.id, hook.data, hook.params];\n        case 'create':\n            return [hook.data, hook.params];\n    }\n    return defaultMakeArguments(hook);\n}\nexports.makeArguments = makeArguments;\n// Converts different hook registration formats into the\n// same internal format\nfunction convertHookData(obj) {\n    let hook = {};\n    if (Array.isArray(obj)) {\n        hook = { all: obj };\n    }\n    else if (typeof obj !== 'object') {\n        hook = { all: [obj] };\n    }\n    else {\n        each(obj, function (value, key) {\n            hook[key] = !Array.isArray(value) ? [value] : value;\n        });\n    }\n    return hook;\n}\nexports.convertHookData = convertHookData;\n// Duck-checks a given object to be a hook object\n// A valid hook object has `type` and `method`\nfunction isHookObject(hookObject) {\n    return typeof hookObject === 'object' &&\n        typeof hookObject.method === 'string' &&\n        typeof hookObject.type === 'string';\n}\nexports.isHookObject = isHookObject;\n// Returns all service and application hooks combined\n// for a given method and type `appLast` sets if the hooks\n// from `app` should be added last (or first by default)\nfunction getHooks(app, service, type, method, appLast = false) {\n    const appHooks = app.__hooks[type][method] || [];\n    const serviceHooks = service.__hooks[type][method] || [];\n    if (appLast) {\n        // Run hooks in the order of service -> app -> finally\n        return serviceHooks.concat(appHooks);\n    }\n    return appHooks.concat(serviceHooks);\n}\nexports.getHooks = getHooks;\nfunction processHooks(hooks, initialHookObject) {\n    let hookObject = initialHookObject;\n    const updateCurrentHook = (current) => {\n        // Either use the returned hook object or the current\n        // hook object from the chain if the hook returned undefined\n        if (current) {\n            if (!isHookObject(current)) {\n                throw new Error(`${hookObject.type} hook for '${hookObject.method}' method returned invalid hook object`);\n            }\n            hookObject = current;\n        }\n        return hookObject;\n    };\n    // Go through all hooks and chain them into our promise\n    const promise = hooks.reduce((current, fn) => {\n        // @ts-ignore\n        const hook = fn.bind(this);\n        // Use the returned hook object or the old one\n        return current.then((currentHook) => hook(currentHook)).then(updateCurrentHook);\n    }, Promise.resolve(hookObject));\n    return promise.then(() => hookObject).catch(error => {\n        // Add the hook information to any errors\n        error.hook = hookObject;\n        throw error;\n    });\n}\nexports.processHooks = processHooks;\n// Add `.hooks` functionality to an object\nfunction enableHooks(obj, methods, types) {\n    if (typeof obj.hooks === 'function') {\n        return obj;\n    }\n    const hookData = {};\n    types.forEach(type => {\n        // Initialize properties where hook functions are stored\n        hookData[type] = {};\n    });\n    // Add non-enumerable `__hooks` property to the object\n    Object.defineProperty(obj, '__hooks', {\n        configurable: true,\n        value: hookData,\n        writable: true\n    });\n    return Object.assign(obj, {\n        hooks(allHooks) {\n            each(allHooks, (current, type) => {\n                // @ts-ignore\n                if (!this.__hooks[type]) {\n                    throw new Error(`'${type}' is not a valid hook type`);\n                }\n                const hooks = convertHookData(current);\n                each(hooks, (_value, method) => {\n                    if (method !== 'all' && methods.indexOf(method) === -1) {\n                        throw new Error(`'${method}' is not a valid hook method`);\n                    }\n                });\n                methods.forEach(method => {\n                    // @ts-ignore\n                    const myHooks = this.__hooks[type][method] || (this.__hooks[type][method] = []);\n                    if (hooks.all) {\n                        myHooks.push.apply(myHooks, hooks.all);\n                    }\n                    if (hooks[method]) {\n                        myHooks.push.apply(myHooks, hooks[method]);\n                    }\n                });\n            });\n            return this;\n        }\n    });\n}\nexports.enableHooks = enableHooks;\n//# sourceMappingURL=hooks.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Removes all leading and trailing slashes from a path\nfunction stripSlashes(name) {\n    return name.replace(/^(\\/+)|(\\/+)$/g, '');\n}\nexports.stripSlashes = stripSlashes;\n// A set of lodash-y utility functions that use ES6\nexports._ = {\n    each(obj, callback) {\n        if (obj && typeof obj.forEach === 'function') {\n            obj.forEach(callback);\n        }\n        else if (exports._.isObject(obj)) {\n            Object.keys(obj).forEach(key => callback(obj[key], key));\n        }\n    },\n    some(value, callback) {\n        return Object.keys(value)\n            .map(key => [value[key], key])\n            .some(([val, key]) => callback(val, key));\n    },\n    every(value, callback) {\n        return Object.keys(value)\n            .map(key => [value[key], key])\n            .every(([val, key]) => callback(val, key));\n    },\n    keys(obj) {\n        return Object.keys(obj);\n    },\n    values(obj) {\n        return exports._.keys(obj).map(key => obj[key]);\n    },\n    isMatch(obj, item) {\n        return exports._.keys(item).every(key => obj[key] === item[key]);\n    },\n    isEmpty(obj) {\n        return exports._.keys(obj).length === 0;\n    },\n    isObject(item) {\n        return (typeof item === 'object' && !Array.isArray(item) && item !== null);\n    },\n    isObjectOrArray(value) {\n        return typeof value === 'object' && value !== null;\n    },\n    extend(first, ...rest) {\n        return Object.assign(first, ...rest);\n    },\n    omit(obj, ...keys) {\n        const result = exports._.extend({}, obj);\n        keys.forEach(key => delete result[key]);\n        return result;\n    },\n    pick(source, ...keys) {\n        return keys.reduce((result, key) => {\n            if (source[key] !== undefined) {\n                result[key] = source[key];\n            }\n            return result;\n        }, {});\n    },\n    // Recursively merge the source object into the target object\n    merge(target, source) {\n        if (exports._.isObject(target) && exports._.isObject(source)) {\n            Object.keys(source).forEach(key => {\n                if (exports._.isObject(source[key])) {\n                    if (!target[key]) {\n                        Object.assign(target, { [key]: {} });\n                    }\n                    exports._.merge(target[key], source[key]);\n                }\n                else {\n                    Object.assign(target, { [key]: source[key] });\n                }\n            });\n        }\n        return target;\n    }\n};\n// Duck-checks if an object looks like a promise\nfunction isPromise(result) {\n    return exports._.isObject(result) &&\n        typeof result.then === 'function';\n}\nexports.isPromise = isPromise;\nfunction makeUrl(path, app = {}) {\n    const get = typeof app.get === 'function' ? app.get.bind(app) : () => { };\n    const env = get('env') || process.env.NODE_ENV;\n    const host = get('host') || process.env.HOST_NAME || 'localhost';\n    const protocol = (env === 'development' || env === 'test' || (env === undefined)) ? 'http' : 'https';\n    const PORT = get('port') || process.env.PORT || 3030;\n    const port = (env === 'development' || env === 'test' || (env === undefined)) ? `:${PORT}` : '';\n    path = path || '';\n    return `${protocol}://${host}${port}/${exports.stripSlashes(path)}`;\n}\nexports.makeUrl = makeUrl;\nfunction createSymbol(name) {\n    return typeof Symbol !== 'undefined' ? Symbol(name) : name;\n}\nexports.createSymbol = createSymbol;\n//# sourceMappingURL=utils.js.map","const debug = require('debug')('@feathersjs/errors');\n\nfunction FeathersError (msg, name, code, className, data) {\n  msg = msg || 'Error';\n\n  let errors;\n  let message;\n  let newData;\n\n  if (msg instanceof Error) {\n    message = msg.message || 'Error';\n\n    // NOTE (EK): This is typically to handle validation errors\n    if (msg.errors) {\n      errors = msg.errors;\n    }\n  } else if (typeof msg === 'object') { // Support plain old objects\n    message = msg.message || 'Error';\n    data = msg;\n  } else { // message is just a string\n    message = msg;\n  }\n\n  if (data) {\n    // NOTE(EK): To make sure that we are not messing\n    // with immutable data, just make a copy.\n    // https://github.com/feathersjs/errors/issues/19\n    newData = JSON.parse(JSON.stringify(data));\n\n    if (newData.errors) {\n      errors = newData.errors;\n      delete newData.errors;\n    } else if (data.errors) {\n      // The errors property from data could be\n      // stripped away while cloning resulting newData not to have it\n      // For example: when cloning arrays this property\n      errors = JSON.parse(JSON.stringify(data.errors));\n    }\n  }\n\n  // NOTE (EK): Babel doesn't support this so\n  // we have to pass in the class name manually.\n  // this.name = this.constructor.name;\n  this.type = 'FeathersError';\n  this.name = name;\n  this.message = message;\n  this.code = code;\n  this.className = className;\n  this.data = newData;\n  this.errors = errors || {};\n\n  debug(`${this.name}(${this.code}): ${this.message}`);\n  debug(this.errors);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, FeathersError);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n}\n\nfunction inheritsFrom (Child, Parent) {\n  Child.prototype = Object.create(Parent.prototype);\n  Child.prototype.constructor = Child;\n}\n\ninheritsFrom(FeathersError, Error);\n\n// NOTE (EK): A little hack to get around `message` not\n// being included in the default toJSON call.\nObject.defineProperty(FeathersError.prototype, 'toJSON', {\n  value: function () {\n    return {\n      name: this.name,\n      message: this.message,\n      code: this.code,\n      className: this.className,\n      data: this.data,\n      errors: this.errors\n    };\n  }\n});\n\n// 400 - Bad Request\nfunction BadRequest (message, data) {\n  FeathersError.call(this, message, 'BadRequest', 400, 'bad-request', data);\n}\n\ninheritsFrom(BadRequest, FeathersError);\n\n// 401 - Not Authenticated\nfunction NotAuthenticated (message, data) {\n  FeathersError.call(this, message, 'NotAuthenticated', 401, 'not-authenticated', data);\n}\n\ninheritsFrom(NotAuthenticated, FeathersError);\n\n// 402 - Payment Error\nfunction PaymentError (message, data) {\n  FeathersError.call(this, message, 'PaymentError', 402, 'payment-error', data);\n}\n\ninheritsFrom(PaymentError, FeathersError);\n\n// 403 - Forbidden\nfunction Forbidden (message, data) {\n  FeathersError.call(this, message, 'Forbidden', 403, 'forbidden', data);\n}\n\ninheritsFrom(Forbidden, FeathersError);\n\n// 404 - Not Found\nfunction NotFound (message, data) {\n  FeathersError.call(this, message, 'NotFound', 404, 'not-found', data);\n}\n\ninheritsFrom(NotFound, FeathersError);\n\n// 405 - Method Not Allowed\nfunction MethodNotAllowed (message, data) {\n  FeathersError.call(this, message, 'MethodNotAllowed', 405, 'method-not-allowed', data);\n}\n\ninheritsFrom(MethodNotAllowed, FeathersError);\n\n// 406 - Not Acceptable\nfunction NotAcceptable (message, data) {\n  FeathersError.call(this, message, 'NotAcceptable', 406, 'not-acceptable', data);\n}\n\ninheritsFrom(NotAcceptable, FeathersError);\n\n// 408 - Timeout\nfunction Timeout (message, data) {\n  FeathersError.call(this, message, 'Timeout', 408, 'timeout', data);\n}\n\ninheritsFrom(Timeout, FeathersError);\n\n// 409 - Conflict\nfunction Conflict (message, data) {\n  FeathersError.call(this, message, 'Conflict', 409, 'conflict', data);\n}\n\ninheritsFrom(Conflict, FeathersError);\n\n// 411 - Length Required\nfunction LengthRequired (message, data) {\n  FeathersError.call(this, message, 'LengthRequired', 411, 'length-required', data);\n}\n\ninheritsFrom(LengthRequired, FeathersError);\n\n// 422 Unprocessable\nfunction Unprocessable (message, data) {\n  FeathersError.call(this, message, 'Unprocessable', 422, 'unprocessable', data);\n}\n\ninheritsFrom(Unprocessable, FeathersError);\n\n// 429 Too Many Requests\nfunction TooManyRequests (message, data) {\n  FeathersError.call(this, message, 'TooManyRequests', 429, 'too-many-requests', data);\n}\n\ninheritsFrom(TooManyRequests, FeathersError);\n\n// 500 - General Error\nfunction GeneralError (message, data) {\n  FeathersError.call(this, message, 'GeneralError', 500, 'general-error', data);\n}\n\ninheritsFrom(GeneralError, FeathersError);\n\n// 501 - Not Implemented\nfunction NotImplemented (message, data) {\n  FeathersError.call(this, message, 'NotImplemented', 501, 'not-implemented', data);\n}\n\ninheritsFrom(NotImplemented, FeathersError);\n\n// 502 - Bad Gateway\nfunction BadGateway (message, data) {\n  FeathersError.call(this, message, 'BadGateway', 502, 'bad-gateway', data);\n}\n\ninheritsFrom(BadGateway, FeathersError);\n\n// 503 - Unavailable\nfunction Unavailable (message, data) {\n  FeathersError.call(this, message, 'Unavailable', 503, 'unavailable', data);\n}\n\ninheritsFrom(Unavailable, FeathersError);\n\nconst errors = {\n  FeathersError,\n  BadRequest,\n  NotAuthenticated,\n  PaymentError,\n  Forbidden,\n  NotFound,\n  MethodNotAllowed,\n  NotAcceptable,\n  Timeout,\n  Conflict,\n  LengthRequired,\n  Unprocessable,\n  TooManyRequests,\n  GeneralError,\n  NotImplemented,\n  BadGateway,\n  Unavailable,\n  400: BadRequest,\n  401: NotAuthenticated,\n  402: PaymentError,\n  403: Forbidden,\n  404: NotFound,\n  405: MethodNotAllowed,\n  406: NotAcceptable,\n  408: Timeout,\n  409: Conflict,\n  411: LengthRequired,\n  422: Unprocessable,\n  429: TooManyRequests,\n  500: GeneralError,\n  501: NotImplemented,\n  502: BadGateway,\n  503: Unavailable\n};\n\nfunction convert (error) {\n  if (!error) {\n    return error;\n  }\n\n  const FeathersError = errors[error.name];\n  const result = FeathersError\n    ? new FeathersError(error.message, error.data)\n    : new Error(error.message || error);\n\n  if (typeof error === 'object') {\n    Object.assign(result, error);\n  }\n\n  return result;\n}\n\nmodule.exports = Object.assign({ convert }, errors);\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\nfunction log(...args) {\n\t// This hackery is required for IE8/9, where\n\t// the `console.log` function doesn't have 'apply'\n\treturn typeof console === 'object' &&\n\t\tconsole.log &&\n\t\tconsole.log(...args);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* Active `debug` instances.\n\t*/\n\tcreateDebug.instances = [];\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.enabled = createDebug.enabled(namespace);\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = selectColor(namespace);\n\t\tdebug.destroy = destroy;\n\t\tdebug.extend = extend;\n\t\t// Debug.formatArgs = formatArgs;\n\t\t// debug.rawLog = rawLog;\n\n\t\t// env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\tcreateDebug.instances.push(debug);\n\n\t\treturn debug;\n\t}\n\n\tfunction destroy() {\n\t\tconst index = createDebug.instances.indexOf(this);\n\t\tif (index !== -1) {\n\t\t\tcreateDebug.instances.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < createDebug.instances.length; i++) {\n\t\t\tconst instance = createDebug.instances[i];\n\t\t\tinstance.enabled = createDebug.enabled(instance.namespace);\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","const errors = require('@feathersjs/errors');\nconst { _ } = require('@feathersjs/commons');\nconst { sorter, select, AdapterService } = require('@feathersjs/adapter-commons');\nconst sift = require('sift').default;\n\nconst _select = (data, ...args) => {\n  const base = select(...args);\n\n  return base(JSON.parse(JSON.stringify(data)));\n};\n\nclass Service extends AdapterService {\n  constructor (options = {}) {\n    super(_.extend({\n      id: 'id',\n      matcher: sift,\n      sorter\n    }, options));\n    this._uId = options.startId || 0;\n    this.store = options.store || {};\n  }\n\n  async getEntries (params = {}) {\n    const { query } = this.filterQuery(params);\n\n    return this._find(Object.assign({}, params, {\n      paginate: false,\n      query\n    }));\n  }\n\n  async _find (params = {}) {\n    const { query, filters, paginate } = this.filterQuery(params);\n    let values = _.values(this.store).filter(this.options.matcher(query));\n    const total = values.length;\n\n    if (filters.$sort !== undefined) {\n      values.sort(this.options.sorter(filters.$sort));\n    }\n\n    if (filters.$skip !== undefined) {\n      values = values.slice(filters.$skip);\n    }\n\n    if (filters.$limit !== undefined) {\n      values = values.slice(0, filters.$limit);\n    }\n\n    const result = {\n      total,\n      limit: filters.$limit,\n      skip: filters.$skip || 0,\n      data: values.map(value => _select(value, params))\n    };\n\n    if (!(paginate && paginate.default)) {\n      return result.data;\n    }\n\n    return result;\n  }\n\n  async _get (id, params = {}) {\n    if (id in this.store) {\n      const { query } = this.filterQuery(params);\n      const value = this.store[id];\n\n      if (this.options.matcher(query)(value)) {\n        return _select(value, params, this.id);\n      }\n    }\n\n    throw new errors.NotFound(`No record found for id '${id}'`);\n  }\n\n  // Create without hooks and mixins that can be used internally\n  async _create (data, params = {}) {\n    if (Array.isArray(data)) {\n      return Promise.all(data.map(current => this._create(current, params)));\n    }\n\n    const id = data[this.id] || this._uId++;\n    const current = _.extend({}, data, { [this.id]: id });\n    const result = (this.store[id] = current);\n\n    return _select(result, params, this.id);\n  }\n\n  async _update (id, data, params = {}) {\n    const oldEntry = await this._get(id);\n    // We don't want our id to change type if it can be coerced\n    const oldId = oldEntry[this.id];\n\n    id = oldId == id ? oldId : id; // eslint-disable-line\n\n    this.store[id] = _.extend({}, data, { [this.id]: id });\n\n    return this._get(id, params);\n  }\n\n  async _patch (id, data, params = {}) {\n    const patchEntry = entry => {\n      const currentId = entry[this.id];\n\n      this.store[currentId] = _.extend(this.store[currentId], _.omit(data, this.id));\n\n      return _select(this.store[currentId], params, this.id);\n    };\n\n    if (id === null) {\n      const entries = await this.getEntries(params);\n\n      return entries.map(patchEntry);\n    }\n\n    return patchEntry(await this._get(id, params)); // Will throw an error if not found\n  }\n\n  // Remove without hooks and mixins that can be used internally\n  async _remove (id, params = {}) {\n    if (id === null) {\n      const entries = await this.getEntries(params);\n\n      return Promise.all(entries.map(\n        current => this._remove(current[this.id], params))\n      );\n    }\n\n    const entry = await this._get(id, params);\n\n    delete this.store[id];\n\n    return entry;\n  }\n}\n\nmodule.exports = options => {\n  return new Service(options);\n};\n\nmodule.exports.Service = Service;\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/*\n *\n * Copryright 2018, Craig Condon\n * Licensed under MIT\n *\n * Filter JavaScript objects with mongodb queries\n */\n\nfunction typeChecker(type) {\n  var typeString = \"[object \" + type + \"]\";\n  return function(value) {\n    return Object.prototype.toString.call(value) === typeString;\n  };\n}\n\n/**\n */\n\nvar isArray = typeChecker(\"Array\");\nvar isObject = typeChecker(\"Object\");\nvar isFunction = typeChecker(\"Function\");\n\nfunction get(obj, key) {\n  return isFunction(obj.get) ? obj.get(key) : obj[key];\n}\n\n\nconst nestable = (validator) => (validateOptions, value, key, valueOwner, nestedResults) => {\n  if (nestedResults) {\n    return Boolean(nestedResults.find(([value, key, valueOwner]) => validator(validateOptions, key, valueOwner)));\n  }\n\n  return validator(validateOptions, value, key, valueOwner);\n};\n\n/**\n */\n\nconst or = nestable((validator) => {\n  return function(validateOptions, value, key, valueOwner, nestedResults) {\n    if (!isArray(value) || !value.length) {\n      return validator(validateOptions, value);\n    }\n    for (var i = 0, n = value.length; i < n; i++) {\n      if (validator(validateOptions, get(value, i))) return true;\n    }\n    return false;\n  };\n});\n\n/**\n */\n\nfunction and(validator) {\n  return function(validateOptions, value, key, valueOwner) {\n    if (!isArray(value) || !value.length) {\n      return validator(validateOptions, value, key, valueOwner);\n    }\n    for (var i = 0, n = value.length; i < n; i++) {\n      if (!validator(validateOptions, get(value, i), value, valueOwner)) return false;\n    }\n    return true;\n  };\n}\n\nfunction validate(validator, value, key, valueOwner, nestedResults) {\n  return validator.validate(validator.options, value, key, valueOwner, nestedResults);\n}\n\nvar defaultExpressions = {\n  /**\n   */\n\n  $eq: or(function(test, value) {\n    return test(value);\n  }),\n\n  /**\n   */\n\n  $ne: and(function(test, value) {\n    return test(value);\n  }),\n\n  /**\n   */\n\n  $gt: or(function(test, value) {\n    return test(value);\n  }),\n\n  /**\n   */\n\n  $gte: or(function(test, value) {\n    return test(value);\n  }),\n\n  /**\n   */\n\n  $lt: or(function(test, value) {\n    return test(value);\n  }),\n\n  /**\n   */\n\n  $lte: or(function(test, value) {\n    return test(value);\n  }),\n\n  /**\n   */\n\n  $mod: or(function(test, value) {\n    return test(value);\n  }),\n\n  /**\n   */\n\n  $in(test, value) {\n    return test(value);\n  },\n\n  /**\n   */\n\n  $nin: function(test, value) {\n    return test(value);\n  },\n\n  /**\n   */\n\n  $not: function(test, value, key, valueOwner) {\n    return test(value, key, valueOwner);\n  },\n\n  /**\n   */\n\n  $type: function(testType, value) {\n    return testType(value);\n  },\n\n  /**\n   */\n\n  $all: function(allOptions, value, key, valueOwner, nestedResults) {\n    return defaultExpressions.$and(allOptions, value, key, valueOwner, nestedResults);\n  },\n\n  /**\n   */\n\n  $size: function(sizeMatch, value) {\n    return value ? sizeMatch === value.length : false;\n  },\n\n  /**\n   */\n\n  $or: function(orOptions, value, key, valueOwner) {\n    for (var i = 0, n = orOptions.length; i < n; i++) {\n      if (validate(get(orOptions, i), value, key, valueOwner)) {\n        return true;\n      }\n    }\n    return false;\n  },\n\n  /**\n   */\n\n  $nor: function(validateOptions, value, key, valueOwner) {\n    return !defaultExpressions.$or(validateOptions, value, key, valueOwner);\n  },\n\n  /**\n   */\n\n  $and: function(validateOptions, value, key, valueOwner, nestedResults) {\n\n    if (nestedResults) {\n      for (var i = 0, n = validateOptions.length; i < n; i++) {\n        if (!validate(get(validateOptions, i), value, key, valueOwner, nestedResults)) {\n          return false;\n        }\n      }\n    } else {\n      for (var i = 0, n = validateOptions.length; i < n; i++) {\n        if (!validate(get(validateOptions, i), value, key, valueOwner, nestedResults)) {\n          return false;\n        }\n      }\n    }\n    return true;\n  },\n\n  /**\n   */\n\n  $regex: or(function(validateOptions, value) {\n    return typeof value === \"string\" && validateOptions.test(value);\n  }),\n\n  /**\n   */\n\n  $where: function(validateOptions, value, key, valueOwner) {\n    return validateOptions.call(value, value, key, valueOwner);\n  },\n\n  /**\n   */\n\n  $elemMatch: function(validateOptions, value, key, valueOwner) {\n    if (isArray(value)) {\n      return !!~search(value, validateOptions);\n    }\n    return validate(validateOptions, value, key, valueOwner);\n  },\n\n  /**\n   */\n\n  $exists: function(validateOptions, value, key, valueOwner) {\n    return valueOwner.hasOwnProperty(key) === validateOptions;\n  }\n};\n\n/**\n */\n\nvar prepare = {\n  /**\n   */\n\n  $eq: function(query, queryOwner, { comparable, compare }) {\n    if (query instanceof RegExp) {\n      return or(function(value) {\n        return typeof value === \"string\" && query.test(value);\n      });\n    } else if (query instanceof Function) {\n      return or(query);\n    } else if (isArray(query) && !query.length) {\n      // Special case of a == []\n      return or(function(value) {\n        return isArray(value) && !value.length;\n      });\n    } else if (query === null) {\n      return or(function(value) {\n        //will match both null and undefined\n        return value == null;\n      });\n    }\n    return or(function(value) {\n      return compare(comparable(value), comparable(query)) === 0;\n    });\n  },\n\n  $gt: function(query, queryOwner, { comparable, compare }) {\n    return function(value) {\n      return compare(comparable(value), comparable(query)) > 0;\n    };\n  },\n\n  $gte: function(query, queryOwner, { comparable, compare }) {\n    return function(value) {\n      return compare(comparable(value), comparable(query)) >= 0;\n    };\n  },\n\n  $lt: function(query, queryOwner, { comparable, compare }) {\n    return function(value) {\n      return compare(comparable(value), comparable(query)) < 0;\n    };\n  },\n  $lte: function(query, queryOwner, { comparable, compare }) {\n    return function(value) {\n      return compare(comparable(value), comparable(query)) <= 0;\n    };\n  },\n\n  $in: function(query, queryOwner, options) {\n    const { comparable } = options;\n    return function(value) {\n      if (value instanceof Array) {\n        for (var i = value.length; i--; ) {\n          if (~query.indexOf(comparable(get(value, i)))) {\n            return true;\n          }\n        }\n      } else {\n        var comparableValue = comparable(value);\n        if (comparableValue === value && typeof value === \"object\") {\n          for (var i = query.length; i--; ) {\n            if (\n              String(query[i]) === String(value) &&\n              String(value) !== \"[object Object]\"\n            ) {\n              return true;\n            }\n          }\n        }\n\n        /*\n          Handles documents that are undefined, whilst also\n          having a 'null' element in the parameters to $in.\n        */\n        if (typeof comparableValue == \"undefined\") {\n          for (var i = query.length; i--; ) {\n            if (query[i] == null) {\n              return true;\n            }\n          }\n        }\n\n        /*\n          Handles the case of {'field': {$in: [/regexp1/, /regexp2/, ...]}}\n        */\n        for (var i = query.length; i--; ) {\n          var validator = createRootValidator(get(query, i), options);\n          var result = validate(validator, comparableValue, i, query);\n          if (\n            result &&\n            String(result) !== \"[object Object]\" &&\n            String(comparableValue) !== \"[object Object]\"\n          ) {\n            return true;\n          }\n        }\n\n        return !!~query.indexOf(comparableValue);\n      }\n\n      return false;\n    };\n  },\n\n  $nin: function(query, queryOwner, options) {\n    const eq = prepare.$in(query, queryOwner, options);\n    return function(validateOptions, value, key, valueOwner) {\n      return !eq(validateOptions, value, key, valueOwner);\n    };\n  },\n\n  $mod: function(query) {\n    return function(value) {\n      return value % query[0] == query[1];\n    };\n  },\n\n  /**\n   */\n\n  $ne: function(query, queryOwner, options) {\n    const eq = prepare.$eq(query, queryOwner, options);\n    return and(function(validateOptions, value, key, valueOwner) {\n      return !eq(validateOptions, value, key, valueOwner);\n    });\n  },\n\n  /**\n   */\n\n  $and: function(query, queryOwner, options) {\n    return query.map(parse(options));\n  },\n\n  /**\n   */\n\n  $all: function(query, queryOwner, options) {\n    return prepare.$and(query, queryOwner, options);\n  },\n\n  /**\n   */\n\n  $or: function(query, queryOwner, options) {\n    return query.map(parse(options));\n  },\n\n  /**\n   */\n\n  $nor: function(query, queryOwner, options) {\n    return query.map(parse(options));\n  },\n\n  /**\n   */\n\n  $not: function(query, queryOwner, options) {\n    const validateOptions = parse(options)(query);\n    return function(value, key, valueOwner) {\n      return !validate(validateOptions, value, key, valueOwner);\n    };\n  },\n\n  $type: function(query) {\n    return function(value, key, valueOwner) {\n      return value != void 0\n        ? value instanceof query || value.constructor == query\n        : false;\n    };\n  },\n\n  /**\n   */\n\n  $regex: function(query, queryOwner) {\n    return new RegExp(query, queryOwner.$options);\n  },\n\n  /**\n   */\n\n  $where: function(query) {\n    return typeof query === \"string\"\n      ? new Function(\"obj\", \"return \" + query)\n      : query;\n  },\n\n  /**\n   */\n\n  $elemMatch: function(query, queryOwner, options) {\n    return parse(options)(query);\n  },\n\n  /**\n   */\n\n  $exists: function(query) {\n    return !!query;\n  }\n};\n\n/**\n */\n\nfunction search(array, validator) {\n  for (var i = 0; i < array.length; i++) {\n    var result = get(array, i);\n    if (validate(validator, get(array, i))) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\n/**\n */\n\nfunction createValidator(options, validate) {\n  return { options, validate };\n}\n\n/**\n */\n\nfunction validatedNested({ keyPath, child, query }, value) {\n  const results = [];\n  findValues(value, keyPath, 0, value, results);\n  \n  if (results.length === 1) {\n    const [value, key, valueOwner] = results[0];\n    return validate(child, value, key, valueOwner);\n  }\n\n  // If the query contains $ne, need to test all elements ANDed together\n  var inclusive = query && typeof query.$ne !== \"undefined\";\n  var allValid = inclusive;\n  const allValues = results.map(([value]) => value);\n\n  return validate(child, undefined, undefined, undefined, results);\n  // for (var i = 0; i < results.length; i++) {\n  //   const [value, key, valueOwner] = results[i];\n  //   var isValid = validate(child, value, key, valueOwner);\n  //   console.log(isValid, value);\n  //   if (inclusive) {\n  //     allValid &= isValid;\n  //   } else {\n  //     allValid |= isValid;\n  //   }\n  // }\n  // return allValid;\n}\n\n/**\n */\n\nfunction findValues(current, keypath, index, object, values) {\n  if (index === keypath.length || current == void 0) {\n    values.push([current, keypath[index - 1], object]);\n    return;\n  }\n\n  var k = get(keypath, index);\n\n  // ensure that if current is an array, that the current key\n  // is NOT an array index. This sort of thing needs to work:\n  // sift({'foo.0':42}, [{foo: [42]}]);\n  if (isArray(current) && isNaN(Number(k))) {\n    for (var i = 0, n = current.length; i < n; i++) {\n      findValues(get(current, i), keypath, index, current, values);\n    }\n  } else {\n    findValues(get(current, k), keypath, index + 1, current, values);\n  }\n}\n\n/**\n */\n\nfunction createNestedValidator(keyPath, child, query) {\n  return createValidator({ keyPath, child, query }, validatedNested);\n}\n\n/**\n * flatten the query\n */\n\nfunction isVanillaObject(value) {\n  return (\n    value &&\n    (value.constructor === Object ||\n      value.constructor === Array ||\n      value.constructor.toString() === \"function Object() { [native code] }\" ||\n      value.constructor.toString() === \"function Array() { [native code] }\")\n  );\n}\n\nfunction parse(options) {\n  const { comparable, expressions } = options;\n  var wrapQuery = function(query) {\n    if (!query || !isVanillaObject(query)) {\n      query = { $eq: query };\n    }\n    return query;\n  };\n\n  var parseQuery = function(query) {\n    query = comparable(query);\n\n    var validators = [];\n\n    for (var key in query) {\n      var queryValue = query[key];\n\n      if (key === \"$options\") {\n        continue;\n      }\n\n      var expression =\n        defaultExpressions[key] || (options && expressions && expressions[key]);\n\n      if (expression) {\n        if (prepare[key]) {\n          queryValue = prepare[key](queryValue, query, options);\n        }\n        validators.push(createValidator(comparable(queryValue), expression));\n      } else {\n        if (key.charCodeAt(0) === 36) {\n          throw new Error(\"Unknown operation \" + key);\n        }\n\n        var keyParts = key.split(\".\");\n\n        validators.push(\n          createNestedValidator(keyParts, parseNested(queryValue), queryValue)\n        );\n      }\n    }\n\n    return validators.length === 1\n      ? validators[0]\n      : createValidator(validators, defaultExpressions.$and);\n  };\n\n  var parseNested = function(query) {\n    query = wrapQuery(query);\n    if (isExactObject(query)) {\n      return createValidator(query, isEqual);\n    }\n    return parseQuery(query);\n  };\n\n  var parseRoot = function(query) {\n    return parseQuery(wrapQuery(query));\n  };\n\n  return parseRoot;\n}\n\nfunction isEqual(a, b) {\n  if (Object.prototype.toString.call(a) !== Object.prototype.toString.call(b)) {\n    return false;\n  }\n\n  if (isObject(a)) {\n    if (Object.keys(a).length !== Object.keys(b).length) {\n      return false;\n    }\n\n    for (var key in a) {\n      if (!isEqual(a[key], b[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  } else if (isArray(a)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (var i = 0, n = a.length; i < n; i++) {\n      if (!isEqual(a[i], b[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  } else {\n    return a === b;\n  }\n}\n\nfunction getAllKeys(value, keys) {\n  if (!isObject(value)) {\n    return keys;\n  }\n  for (var key in value) {\n    keys.push(key);\n    getAllKeys(value[key], keys);\n  }\n  return keys;\n}\n\nfunction isExactObject(value) {\n  const allKeysHash = getAllKeys(value, []).join(\",\");\n  return allKeysHash.search(/[$.]/) === -1;\n}\n\n/**\n */\n\nfunction createRootValidator(query, options) {\n  var validator = parse(options)(query);\n  if (options && options.select) {\n    validator = {\n      options: validator,\n      validate: function(validateOptions, value, key, valueOwner) {\n        return validate(\n          validateOptions,\n          value && options.select(value),\n          key,\n          valueOwner\n        );\n      }\n    };\n  }\n  return validator;\n}\n\n/**\n */\n\nexport default function sift(query, options) {\n  options = Object.assign({ compare, comparable }, options);\n  var validator = createRootValidator(query, options);\n  return function(value, key, valueOwner) {\n    return validate(validator, value, key, valueOwner);\n  };\n}\n\n/**\n */\n\nexport function compare(a, b) {\n  if (isEqual(a, b)) return 0;\n  if (typeof a === typeof b) {\n    if (a > b) {\n      return 1;\n    }\n    if (a < b) {\n      return -1;\n    }\n  }\n}\n\n/**\n */\n\nexport function comparable(value) {\n  if (value instanceof Date) {\n    return value.getTime();\n  } else if (isArray(value)) {\n    return value.map(comparable);\n  } else if (value && typeof value.toJSON === \"function\") {\n    return value.toJSON();\n  } else {\n    return value;\n  }\n}\n"],"sourceRoot":""}